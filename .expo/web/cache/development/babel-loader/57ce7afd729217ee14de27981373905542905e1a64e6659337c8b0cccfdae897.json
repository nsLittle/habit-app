{"ast":null,"code":"var _asyncToGenerator = require(\"@babel/runtime/helpers/asyncToGenerator\");\nvar _require = require(\"../models/User\"),\n  User = _require.User;\nexports.getUserProfile = function () {\n  var _ref = _asyncToGenerator(function* (req, res) {\n    try {\n      var username = req.params.username;\n      console.log('req.params:', req.params);\n      var user = yield User.findOne({\n        username: username\n      }).populate('habits teamMember');\n      console.log('user:', user);\n      if (!user) return res.status(404).json({\n        message: 'User not found'\n      });\n      res.status(200).json(user);\n    } catch (error) {\n      console.error('Error in getUserProfile:', error.message);\n      res.status(400).json({\n        error: error.message\n      });\n    }\n  });\n  return function (_x, _x2) {\n    return _ref.apply(this, arguments);\n  };\n}();\nexports.updateUserProfile = function () {\n  var _ref2 = _asyncToGenerator(function* (req, res) {\n    try {\n      var username = req.params.username;\n      var updatedUser = yield User.findOneAndUpdate({\n        username: username\n      }, req.body, {\n        new: true\n      });\n      res.status(200).json({\n        message: 'Profile updated successfully',\n        updatedUser: updatedUser\n      });\n    } catch (error) {\n      res.status(400).json({\n        error: error.message\n      });\n    }\n  });\n  return function (_x3, _x4) {\n    return _ref2.apply(this, arguments);\n  };\n}();\nexports.deleteUserProfile = function () {\n  var _ref3 = _asyncToGenerator(function* (req, res) {\n    try {\n      var username = req.params.username;\n      var requester = req.user;\n      var user = yield User.findOne({\n        username: username\n      });\n      if (!user) {\n        return res.status(404).json({\n          message: 'User not found'\n        });\n      }\n      if (requester.role === 'admin') {\n        yield User.deleteOne({\n          username: username\n        });\n        return res.status(200).json({\n          message: 'User deleted permanently'\n        });\n      } else if (requester.username === username) {\n        user.isDeleted = true;\n        yield user.save();\n        return res.status(200).json({\n          message: 'User deleted (soft delete)'\n        });\n      } else {\n        return res.status(403).json({\n          message: 'Unauthorized to delete this user'\n        });\n      }\n    } catch (error) {\n      console.error('Error in deleteUserProfile:', error.message);\n      res.status(400).json({\n        error: error.message\n      });\n    }\n  });\n  return function (_x5, _x6) {\n    return _ref3.apply(this, arguments);\n  };\n}();","map":{"version":3,"names":["_require","require","User","exports","getUserProfile","_ref","_asyncToGenerator","req","res","username","params","console","log","user","findOne","populate","status","json","message","error","_x","_x2","apply","arguments","updateUserProfile","_ref2","updatedUser","findOneAndUpdate","body","new","_x3","_x4","deleteUserProfile","_ref3","requester","role","deleteOne","isDeleted","save","_x5","_x6"],"sources":["/Users/nslittle/Desktop/Life/coding/habit-app/server/controllers/userController.js"],"sourcesContent":["const { User } = require('../models/User');\n\nexports.getUserProfile = async (req, res) => {\n  try {\n    const { username } = req.params;\n    console.log('req.params:', req.params);\n\n    const user = await User.findOne({ username }).populate('habits teamMember');\n    console.log('user:', user);\n\n    if (!user) return res.status(404).json({ message: 'User not found' });\n\n    res.status(200).json(user);\n  } catch (error) {\n    console.error('Error in getUserProfile:', error.message);\n    res.status(400).json({ error: error.message });\n  }\n};\n\nexports.updateUserProfile = async (req, res) => {\n  try {\n    const { username } = req.params;\n    const updatedUser = await User.findOneAndUpdate({ username }, req.body, { new: true });\n    res.status(200).json({ message: 'Profile updated successfully', updatedUser });\n  } catch (error) {\n    res.status(400).json({ error: error.message });\n  }\n};\n\nexports.deleteUserProfile = async (req, res) => {\n  try {\n    const { username } = req.params;\n    const requester = req.user;\n\n    const user = await User.findOne({ username });\n    if (!user) {\n      return res.status(404).json({ message: 'User not found' });\n    }\n\n    if (requester.role === 'admin') {\n      await User.deleteOne({ username });\n      return res.status(200).json({ message: 'User deleted permanently' });\n    } else if (requester.username === username) {\n      user.isDeleted = true;\n      await user.save();\n      return res.status(200).json({ message: 'User deleted (soft delete)' });\n    } else {\n      return res.status(403).json({ message: 'Unauthorized to delete this user' });\n    }\n  } catch (error) {\n    console.error('Error in deleteUserProfile:', error.message);\n    res.status(400).json({ error: error.message });\n  }\n};"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"script","externalDependencies":[]}